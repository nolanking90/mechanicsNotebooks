(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45136,       1170]
NotebookOptionsPosition[     41800,       1108]
NotebookOutlinePosition[     42359,       1126]
CellTagsIndexPosition[     42316,       1123]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "L", ",", "m1", ",", "m2", ",", "l", ",", "l1", ",", "l2", ",", "\[Theta]1",
    ",", "\[Theta]2", ",", "\[Omega]1", ",", "\[Omega]2", ",", "x1", ",", 
   "x2", ",", "y1", ",", "y2", ",", "\[Alpha]", ",", " ", "\[Theta]", ",", 
   " ", "\[CapitalOmega]1", ",", " ", "\[CapitalOmega]2", ",", "g", ",", " ", 
   "kx", ",", " ", "ky", ",", "M", ",", "R"}], "]"}]], "Input",
 CellChangeTimes->{{3.917354981800434*^9, 3.9173550020314217`*^9}, 
   3.917355041025216*^9, 3.917355141179406*^9, {3.917355281033662*^9, 
   3.91735532417533*^9}, {3.9173554649529347`*^9, 3.9173554692955227`*^9}, {
   3.917355517840826*^9, 3.917355518650042*^9}, {3.917355579309414*^9, 
   3.917355804593357*^9}, {3.917355838301936*^9, 3.9173561264049597`*^9}, {
   3.917356176532597*^9, 3.9173562417403727`*^9}, {3.917356330705529*^9, 
   3.917356330882861*^9}, {3.91735636569481*^9, 3.9173563703080063`*^9}, {
   3.917356407435073*^9, 3.917356413255798*^9}, {3.917356457111312*^9, 
   3.917356473386951*^9}, {3.917356511023566*^9, 3.917356543114431*^9}, {
   3.917356576952792*^9, 3.917356577524283*^9}, {3.917356609115712*^9, 
   3.917356714103365*^9}, {3.9173567678243318`*^9, 3.917356772439172*^9}, {
   3.917357930661066*^9, 3.917357932972767*^9}, 3.917376926005573*^9, {
   3.917379711930527*^9, 3.917379761213522*^9}, {3.917415282116665*^9, 
   3.917415456174057*^9}, {3.917415909735847*^9, 3.917416049697038*^9}, {
   3.9174162430298977`*^9, 3.917416248588332*^9}, {3.917602330310507*^9, 
   3.917602330590078*^9}, {3.922603019735347*^9, 3.922603019982884*^9}, {
   3.922603958003335*^9, 3.922603983842847*^9}, {3.922610590515576*^9, 
   3.922610590706935*^9}},
 CellLabel->
  "In[1642]:=",ExpressionUUID->"035e3a20-2905-4eac-88b7-5e28edc4a27e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"l1", " ", "=", " ", 
   RowBox[{"l2", " ", "=", " ", 
    RowBox[{"m1", " ", "=", " ", 
     RowBox[{"m2", " ", "=", " ", "1"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.917416588047867*^9, 3.917416593308049*^9}, {
   3.918829423985786*^9, 3.9188294250811367`*^9}, 3.922373347709754*^9, 
   3.92246678927029*^9, {3.9226030099193*^9, 3.922603010278553*^9}},
 CellLabel->
  "In[1643]:=",ExpressionUUID->"59dab671-9ba0-4b7c-bce0-330c0e5931f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x1", " ", "=", " ", 
   RowBox[{"l1", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", " ", "=", " ", 
   RowBox[{"l1", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"x2", " ", "=", " ", 
   RowBox[{"x1", " ", "+", " ", 
    RowBox[{"l2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y2", " ", "=", " ", 
   RowBox[{"y1", " ", "+", " ", 
    RowBox[{"l2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kx", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ky", " ", "=", " ", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.917354981800434*^9, 3.9173550020314217`*^9}, 
   3.917355041025216*^9, 3.917355141179406*^9, {3.917355281033662*^9, 
   3.91735532417533*^9}, {3.9173554649529347`*^9, 3.9173554692955227`*^9}, {
   3.917355517840826*^9, 3.917355518650042*^9}, {3.917355579309414*^9, 
   3.917355804593357*^9}, {3.917355838301936*^9, 3.9173561264049597`*^9}, {
   3.917356176532597*^9, 3.9173562417403736`*^9}, {3.917356330705529*^9, 
   3.917356330882861*^9}, {3.91735636569481*^9, 3.9173563703080063`*^9}, {
   3.917356407435073*^9, 3.917356413255798*^9}, {3.917356457111312*^9, 
   3.917356473386951*^9}, {3.917356511023566*^9, 3.917356543114431*^9}, {
   3.917356576952792*^9, 3.917356577524283*^9}, {3.917356609115712*^9, 
   3.917356714103365*^9}, {3.917356767824332*^9, 3.917356772439172*^9}, {
   3.917357930661066*^9, 3.917357932972767*^9}, 3.917376926005573*^9, {
   3.917379711930527*^9, 3.917379761213522*^9}, {3.917415282116665*^9, 
   3.917415456174057*^9}, {3.917415909735847*^9, 3.917416084988286*^9}, {
   3.922603439717174*^9, 3.9226034595006123`*^9}, {3.922603856642625*^9, 
   3.922603856787251*^9}, {3.922605083355851*^9, 3.922605083486279*^9}, {
   3.922605125263833*^9, 3.9226051529953203`*^9}, {3.922605264466254*^9, 
   3.922605264794086*^9}, {3.922605295010529*^9, 3.922605295161954*^9}, {
   3.9226082824108753`*^9, 3.922608309473654*^9}},
 CellLabel->
  "In[1644]:=",ExpressionUUID->"687be03f-4b0b-4121-928d-35ee0515c044"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", ",", " ", "0", ",", "0", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "m1", ",", " ", "0", ",", " ", "0"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "m2", ",", " ", "0"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "m2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "[", 
    RowBox[{"q_", ",", " ", "v_", ",", " ", "k_"}], "]"}], ":=", 
   "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], " ", 
     RowBox[{"v", ".", "M", ".", "v"}]}], "  ", "+", 
    RowBox[{"g", " ", 
     RowBox[{"k", ".", "M", ".", "q"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", "\[Beta]_", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Beta]", "]"}], ",", " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}], ",", "0", ",", "0"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Beta]", "]"}]}], ",", " ", 
       RowBox[{"Cos", "[", "\[Beta]", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"Cos", "[", "\[Beta]", "]"}], ",", " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Beta]", "]"}]}], ",", " ", 
       RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}], ",", "t"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", "ky", ",", "kx", ",", "ky"}], "}"}]}], "]"}], " ", "==",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", " ", "y1", ",", " ", "x2", ",", " ", "y2"}], 
          "}"}], ",", "t"}], "]"}], ".", "M", ".", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1", ",", " ", "x2", ",", " ", "y2"}], "}"}], 
         ",", "t"}], "]"}]}]}], "  ", "+", " ", 
     RowBox[{"g", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kx", ",", " ", "ky", ",", " ", "kx", ",", " ", "ky"}], "}"}],
        ".", "M", ".", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}]}]}]}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.92260371044835*^9, 3.922603892901044*^9}, {
   3.9226039395932207`*^9, 3.922603950811452*^9}, {3.922604014010111*^9, 
   3.922604265148761*^9}, {3.9226042969727097`*^9, 3.922604387586467*^9}, {
   3.922605090529582*^9, 3.922605128360993*^9}, {3.9226051604786797`*^9, 
   3.922605160989603*^9}, {3.922605197628757*^9, 3.922605204201942*^9}, {
   3.922605235083704*^9, 3.9226052602263317`*^9}, {3.922605292284813*^9, 
   3.922605300682353*^9}, {3.922606217358139*^9, 3.922606233858815*^9}, 
   3.9226069259181747`*^9, {3.9226094545692587`*^9, 3.9226094772166023`*^9}, 
   3.922609940634222*^9, {3.922610603621729*^9, 3.9226106409928083`*^9}, {
   3.92261067396027*^9, 3.922610674828231*^9}},
 CellLabel->
  "In[1650]:=",ExpressionUUID->"82827647-4895-4b98-a331-e24511d5a1c9"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.9226043239055634`*^9, 3.922604388965724*^9, {3.9226050952841988`*^9, 
   3.92260512890171*^9}, {3.9226051838748093`*^9, 3.9226052056687927`*^9}, {
   3.922605241672171*^9, 3.922605268489653*^9}, 3.922605302709841*^9, 
   3.9226064789408712`*^9, 3.922606635043665*^9, {3.922608286150847*^9, 
   3.9226083134443073`*^9}, 3.922609798127213*^9, 3.922609941556982*^9, 
   3.9226106757528563`*^9},
 CellLabel->
  "Out[1653]=",ExpressionUUID->"8f0cabd7-3f83-4836-bb81-d3d46e4caeb6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"R", "[", "\[Theta]", "]"}], "]"}], "==", 
   RowBox[{"R", "[", 
    RowBox[{"-", "\[Theta]"}], "]"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.92261167243475*^9, 3.9226116858426533`*^9}},
 CellLabel->
  "In[1666]:=",ExpressionUUID->"2399f634-910d-456d-9adc-713855ccc670"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9226116864664707`*^9},
 CellLabel->
  "Out[1666]=",ExpressionUUID->"e581d11a-af6f-428a-81d4-e3048d988479"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], " ", "==", " ", 
   
   RowBox[{"{", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "x2", ",", " ", "y2"}], "}"}]}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.922609887455081*^9, 3.922609910616026*^9}, {
   3.922609992489723*^9, 3.922609996911327*^9}, 3.922610303025508*^9, {
   3.92261035233497*^9, 3.9226103528529167`*^9}, {3.922610383089047*^9, 
   3.922610387974811*^9}, {3.922610472042666*^9, 3.9226104821205482`*^9}, {
   3.922610818578397*^9, 3.9226108264240713`*^9}},
 CellLabel->
  "In[1654]:=",ExpressionUUID->"14e66be6-43ca-485c-a18d-a1b51b4d4d9a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9226099114445972`*^9, 3.922609944640026*^9, 
  3.922610004670375*^9, 3.922610305336878*^9, 3.922610390117309*^9, 
  3.922610518969239*^9, 3.922610679564333*^9},
 CellLabel->
  "Out[1654]=",ExpressionUUID->"1bad40ad-ddd0-4374-829e-f61f1bf497f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"l", " ", "=", " ", 
  RowBox[{
   RowBox[{"L", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
         RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "+", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
           RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], ",", "t"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky", ",", "kx", ",", "ky"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", " ", "==", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", " ", "y1", ",", " ", "x2", ",", " ", "y2"}], 
         "}"}], ",", "t"}], "]"}], ".", "M", ".", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", " ", "x2", ",", " ", "y2"}], "}"}], 
        ",", "t"}], "]"}]}]}], "  ", "+", " ", 
    RowBox[{"g", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kx", ",", " ", "ky", ",", " ", "kx", ",", " ", "ky"}], "}"}], 
      ".", "M", ".", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}]}]}]}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", " ", "\[IndentingNewLine]", 
  RowBox[{
  "\"\<Check if L is (GxV)-invariant: \>\"", " ", ",", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"l", " ", "==", " ", 
     RowBox[{"L", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "+", "\[Beta]"}], "]"}], ".", 
         
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "+", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "+", "\[Beta]"}], "]"}], ".", 
         
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "+", "\[Beta]"}], "]"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "+", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{
             RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
             RowBox[{"\[Theta]", "[", "t", "]"}], "+", "\[Beta]"}], "]"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
         "t"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "[", "\[Beta]", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky", ",", "kx", ",", "ky"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "//", "FullSimplify"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.92260371044835*^9, 3.922603892901044*^9}, {
   3.9226039395932207`*^9, 3.922603950811452*^9}, {3.922604014010111*^9, 
   3.922604265148761*^9}, {3.9226042969727097`*^9, 3.922604322468788*^9}, {
   3.922604399331514*^9, 3.922604436211472*^9}, {3.922604470143875*^9, 
   3.922604475008478*^9}, {3.9226045120603867`*^9, 3.922604550805667*^9}, {
   3.922604611005437*^9, 3.922604662057005*^9}, {3.922604761557988*^9, 
   3.9226047639033422`*^9}, {3.9226061269577847`*^9, 3.922606142397937*^9}, {
   3.92260620359203*^9, 3.922606212923395*^9}, {3.92260647045201*^9, 
   3.922606494395912*^9}, {3.922606813605198*^9, 3.922606818114688*^9}, {
   3.9226068877686863`*^9, 3.922606914249548*^9}, {3.9226069535418653`*^9, 
   3.922606989881545*^9}, {3.922607383751336*^9, 3.922607428215246*^9}, {
   3.922608631500966*^9, 3.922608637070612*^9}, {3.922609512118322*^9, 
   3.9226096195602093`*^9}, {3.92260971368484*^9, 3.922609714207941*^9}, 
   3.922609747258497*^9, {3.922609801387677*^9, 3.922609804882057*^9}, {
   3.9226102303379087`*^9, 3.922610273747675*^9}, {3.922610347480362*^9, 
   3.922610348117099*^9}, {3.922610400211569*^9, 3.9226104049953947`*^9}, {
   3.9226106899098*^9, 3.922610690596972*^9}, {3.922610759020063*^9, 
   3.9226107925531797`*^9}, {3.922610855343876*^9, 3.92261085791276*^9}},
 CellLabel->
  "In[1658]:=",ExpressionUUID->"28e9b664-16f5-45b5-a8b3-b37a49449536"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "g"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Alpha]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["3", "2"], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.9226064962497377`*^9, 3.922606639812029*^9, {3.92260682133457*^9, 
   3.922606832840959*^9}, 3.922606939434376*^9, {3.922607422667836*^9, 
   3.922607428835672*^9}, {3.922608292854871*^9, 3.922608315163581*^9}, 
   3.9226086547580137`*^9, 3.922608690176239*^9, 3.922609638373519*^9, 
   3.9226097163851757`*^9, 3.922609749515868*^9, 3.922609807331167*^9, 
   3.922610283494747*^9, 3.922610409214422*^9, 3.922610531345044*^9, 
   3.922610684676609*^9, 3.9226108670264673`*^9},
 CellLabel->
  "Out[1658]=",ExpressionUUID->"44a219d1-5b86-4d8d-8bb2-852c4328fc55"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.9226064962497377`*^9, 3.922606639812029*^9, {3.92260682133457*^9, 
   3.922606832840959*^9}, 3.922606939434376*^9, {3.922607422667836*^9, 
   3.922607428835672*^9}, {3.922608292854871*^9, 3.922608315163581*^9}, 
   3.9226086547580137`*^9, 3.922608690176239*^9, 3.922609638373519*^9, 
   3.9226097163851757`*^9, 3.922609749515868*^9, 3.922609807331167*^9, 
   3.922610283494747*^9, 3.922610409214422*^9, 3.922610531345044*^9, 
   3.922610684676609*^9, 3.92261086702842*^9},
 CellLabel->
  "Out[1659]=",ExpressionUUID->"65444e57-6719-4db9-9b86-4e2b4f2e8c94"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Check if L is (GxV)-invariant: \"\>", "\[InvisibleSpace]", 
   "True"}],
  SequenceForm["Check if L is (GxV)-invariant: ", True],
  Editable->False]], "Print",
 CellChangeTimes->{{3.922607422670081*^9, 3.9226074288374577`*^9}, {
   3.922608292887076*^9, 3.922608315170926*^9}, 3.922608654761318*^9, 
   3.9226086901781397`*^9, 3.922609638900426*^9, 3.922609716729712*^9, 
   3.922609749763339*^9, 3.922609807520015*^9, 3.922610283820133*^9, 
   3.922610409218384*^9, 3.922610531348422*^9, 3.9226106846818533`*^9, 
   3.922610867079214*^9},
 CellLabel->
  "During evaluation of \
In[1658]:=",ExpressionUUID->"fd899969-f47a-4236-be95-0c2ee0118355"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lbody", " ", "=", " ", 
  RowBox[{
   RowBox[{"L", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"R", "[", "0", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"-", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "+", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{
            RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
            RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], ",", "t"}],
        "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"-", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"kx", ",", "ky", ",", "kx", ",", "ky"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.922611433833117*^9, 3.922611520215637*^9}, {
  3.922611749099018*^9, 3.922611775846754*^9}},
 CellLabel->
  "In[1667]:=",ExpressionUUID->"dbca5b09-1214-4be0-a0c3-d179cf565664"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "g"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Alpha]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["3", "2"], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.922611473144998*^9, 3.92261147907312*^9}, 
   3.922611523596261*^9, 3.922611804759406*^9},
 CellLabel->
  "Out[1667]=",ExpressionUUID->"1601102f-223c-46ba-ad7b-fc9fb33c6ab3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"lbody", "-", " ", 
      RowBox[{"\[Eta]", " ", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}]}], ")"}], "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"l", ",", " ", 
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], "==", 
       "\[Eta]"}], ",", " ", 
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r", "=", 
  RowBox[{
   RowBox[{"r", "//", "FullSimplify"}], "//", "First"}]}]}], "Input",
 CellChangeTimes->{{3.92260835586963*^9, 3.922608450069401*^9}, {
  3.922611812840551*^9, 3.922611814405931*^9}},
 CellLabel->
  "In[1668]:=",ExpressionUUID->"8b1bda59-3e70-42c0-a79c-c404d22da849"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"6", "+", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}]}]], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[Eta]", "2"], "+", 
     RowBox[{"2", " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
          RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "\[Eta]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\[Alpha]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Alpha]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.922608444877602*^9, 3.9226084505503407`*^9}, 
   3.9226086655639553`*^9, 3.922608697086172*^9, 3.9226114067664633`*^9, 
   3.922611845052593*^9},
 CellLabel->
  "Out[1669]=",ExpressionUUID->"0fd69742-b822-4c19-be79-9ea494ecddb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"l", ",", " ", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
    "]"}], "-", 
   RowBox[{"D", "[", 
    RowBox[{"l", ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"l", ",", " ", 
       RowBox[{
        RowBox[{"\[Alpha]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
    "]"}], "-", 
   RowBox[{"D", "[", 
    RowBox[{"l", ",", 
     RowBox[{"\[Alpha]", "[", "t", "]"}]}], "]"}]}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.92260371044835*^9, 3.922603892901044*^9}, {
  3.9226039395932207`*^9, 3.922603950811452*^9}, {3.922604014010111*^9, 
  3.922604265148761*^9}, {3.9226042969727097`*^9, 3.922604322468788*^9}, {
  3.922604399331514*^9, 3.922604436211472*^9}, {3.922604470143875*^9, 
  3.922604475008478*^9}, {3.9226045120603867`*^9, 3.922604550805667*^9}, {
  3.922604611005437*^9, 3.922604662057005*^9}, {3.922604761557988*^9, 
  3.9226047639033422`*^9}, {3.9226061269577847`*^9, 3.922606142397937*^9}, {
  3.92260620359203*^9, 3.922606212923395*^9}, {3.92260647045201*^9, 
  3.922606494395912*^9}},ExpressionUUID->"c636ac82-c9d0-4959-aa93-\
014c7e082334"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["g", "2"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Beta]"}], "+", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"2", " ", "\[Beta]"}], "+", 
       RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Alpha]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["3", "2"], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.922604165411151*^9, 3.922604199965345*^9, 3.922604267346943*^9, {
   3.9226043115175047`*^9, 3.922604326138269*^9}, {3.9226043919576397`*^9, 
   3.922604437460771*^9}, 3.922604482449706*^9, 3.922604516889592*^9, 
   3.922604552163818*^9, 3.922604619758729*^9, 3.922604663146956*^9, 
   3.922604764632016*^9, 3.922605313889536*^9, {3.9226061314203663`*^9, 
   3.922606143226345*^9}, {3.922606480568534*^9, 3.922606487739912*^9}},
 CellLabel->
  "Out[1551]=",ExpressionUUID->"b12680e1-c655-4089-8d54-bf6555139d49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["g", "2"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Beta]"}], "+", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"2", " ", "\[Beta]"}], "+", 
       RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Alpha]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"3", "+", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.922604165411151*^9, 3.922604199965345*^9, 3.922604267346943*^9, {
   3.9226043115175047`*^9, 3.922604326138269*^9}, {3.9226043919576397`*^9, 
   3.922604437460771*^9}, 3.922604482449706*^9, 3.922604516889592*^9, 
   3.922604552163818*^9, 3.922604619758729*^9, 3.922604663146956*^9, 
   3.922604764632016*^9, 3.922605313889536*^9, {3.9226061314203663`*^9, 
   3.922606143226345*^9}, {3.922606480568534*^9, 3.9226064877954493`*^9}},
 CellLabel->
  "Out[1552]=",ExpressionUUID->"7d49913f-a041-48c8-9e13-18106ccaa81b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["g", "2"]}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "\[Beta]"}], "+", 
     RowBox[{"\[Alpha]", "[", "t", "]"}], "+", 
     RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.922604165411151*^9, 3.922604199965345*^9, 3.922604267346943*^9, {
   3.9226043115175047`*^9, 3.922604326138269*^9}, {3.9226043919576397`*^9, 
   3.922604437460771*^9}, 3.922604482449706*^9, 3.922604516889592*^9, 
   3.922604552163818*^9, 3.922604619758729*^9, 3.922604663146956*^9, 
   3.922604764632016*^9, 3.922605313889536*^9, {3.9226061314203663`*^9, 
   3.922606143226345*^9}, {3.922606480568534*^9, 3.9226064878228083`*^9}},
 CellLabel->
  "Out[1553]=",ExpressionUUID->"fc4a5e02-8e40-40f2-8d05-4698606de230"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"m1", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x1", ",", "t"}], "]"}], "^", "2"}], " ", "+", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"y1", ",", "t"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+",
         " ", 
        RowBox[{"m2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x2", ",", "t"}], "]"}], "^", "2"}], " ", "+", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"y2", ",", "t"}], "]"}], "^", "2"}]}], ")"}]}]}], 
       ")"}]}], " ", "-", " ", 
     RowBox[{"m1", " ", "g", " ", "y1"}], " ", "-", " ", 
     RowBox[{"m2", " ", "g", " ", "y2"}]}], "//", "FullSimplify"}]}], " ", 
  ";"}]], "Input",
 CellChangeTimes->{{3.917354981800434*^9, 3.9173550020314217`*^9}, 
   3.917355041025216*^9, 3.917355141179406*^9, {3.917355281033662*^9, 
   3.91735532417533*^9}, {3.9173554649529347`*^9, 3.9173554692955227`*^9}, {
   3.917355517840826*^9, 3.917355518650042*^9}, {3.917355579309414*^9, 
   3.917355804593357*^9}, {3.917355838301936*^9, 3.9173561264049597`*^9}, {
   3.917356176532597*^9, 3.9173562417403736`*^9}, {3.917356330705529*^9, 
   3.917356330882861*^9}, {3.91735636569481*^9, 3.9173563703080063`*^9}, {
   3.917356407435073*^9, 3.917356413255798*^9}, {3.917356457111312*^9, 
   3.917356473386951*^9}, {3.917356511023566*^9, 3.917356543114431*^9}, {
   3.917356576952792*^9, 3.917356577524283*^9}, {3.917356609115712*^9, 
   3.917356714103365*^9}, {3.917356767824332*^9, 3.917356772439172*^9}, {
   3.917357930661066*^9, 3.917357932972767*^9}, 3.917376926005573*^9, {
   3.917379711930527*^9, 3.917379761213522*^9}, {3.917415282116665*^9, 
   3.917415456174057*^9}, {3.917415909735847*^9, 3.917416140663857*^9}, {
   3.917601141520438*^9, 3.917601153094711*^9}, {3.922466002620083*^9, 
   3.922466009883821*^9}, {3.922466041579661*^9, 3.9224660421816607`*^9}, {
   3.922466555716574*^9, 3.922466562799292*^9}, 3.922468757727012*^9, 
   3.922603932396372*^9},
 CellLabel->
  "In[1393]:=",ExpressionUUID->"d3b9c01c-0f50-449d-b808-3b5845af9082"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"L", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "->", "\[Omega]1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Alpha]", "'"}], "[", "t", "]"}], "->", "\[Omega]2"}], ",",
        " ", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "t", "]"}], "->", "\[Theta]"}], ",", " ", 
       RowBox[{
        RowBox[{"\[Alpha]", "[", "t", "]"}], "->", "\[Alpha]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", " ", "=", 
   RowBox[{"FullSimplify", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"L", ",", "\[Omega]1"}], "]"}], "\[Omega]1"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"L", ",", "\[Omega]2"}], "]"}], "\[Omega]2"}], " ", "-", " ", 
     "L"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<L = \>\"", ",", " ", "L"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<E = \>\"", ",", " ", "e"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.917354981800434*^9, 3.9173550020314217`*^9}, 
   3.917355041025216*^9, 3.917355141179406*^9, {3.917355281033662*^9, 
   3.91735532417533*^9}, {3.9173554649529347`*^9, 3.9173554692955227`*^9}, {
   3.917355517840826*^9, 3.917355518650042*^9}, {3.917355579309414*^9, 
   3.917355804593357*^9}, {3.917355838301936*^9, 3.9173561264049597`*^9}, {
   3.917356176532597*^9, 3.9173562417403736`*^9}, {3.917356330705529*^9, 
   3.917356330882861*^9}, {3.91735636569481*^9, 3.9173563703080063`*^9}, {
   3.917356407435073*^9, 3.917356413255798*^9}, {3.917356457111312*^9, 
   3.917356473386951*^9}, {3.917356511023566*^9, 3.917356543114431*^9}, {
   3.917356576952792*^9, 3.917356577524283*^9}, {3.917356609115712*^9, 
   3.917356714103365*^9}, {3.917356767824332*^9, 3.917356772439172*^9}, {
   3.917357930661066*^9, 3.917357932972767*^9}, 3.917376926005573*^9, {
   3.917379711930527*^9, 3.917379761213522*^9}, {3.917415282116665*^9, 
   3.917415456174057*^9}, {3.917415909735847*^9, 3.917416140663857*^9}, {
   3.917601141520438*^9, 3.917601153094711*^9}, {3.922466002620083*^9, 
   3.922466009883821*^9}, {3.922466041579661*^9, 3.9224660421816607`*^9}, {
   3.922466555716574*^9, 3.922466562799292*^9}, 3.922468757727012*^9, 
   3.922603932396372*^9},ExpressionUUID->"56c42327-e744-44cc-8adc-\
a032ef37ac7e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"L = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       SuperscriptBox["\[Omega]1", "2"]}], "+", 
      RowBox[{"2", " ", "\[Omega]1", " ", "\[Omega]2"}], "+", 
      SuperscriptBox["\[Omega]2", "2"], "+", 
      RowBox[{"2", " ", "\[Omega]1", " ", 
       RowBox[{"(", 
        RowBox[{"\[Omega]1", "+", "\[Omega]2"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
      RowBox[{"2", " ", "g", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Alpha]", "+", "\[Theta]"}], "]"}]}], ")"}]}]}], ")"}]}]}],
  SequenceForm[
  "L = ", Rational[1, 2] (3 $CellContext`\[Omega]1^2 + 
    2 $CellContext`\[Omega]1 $CellContext`\[Omega]2 + \
$CellContext`\[Omega]2^2 + 
    2 $CellContext`\[Omega]1 ($CellContext`\[Omega]1 + $CellContext`\[Omega]2)
       Cos[$CellContext`\[Alpha]] - 
    2 $CellContext`g (2 Cos[$CellContext`\[Theta]] + 
     Cos[$CellContext`\[Alpha] + $CellContext`\[Theta]]))],
  Editable->False]], "Print",
 CellChangeTimes->{3.922603027673039*^9},
 CellLabel->
  "During evaluation of \
In[1372]:=",ExpressionUUID->"309d0d7c-6f40-445b-8b98-d94fdc0d2399"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"E = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[Omega]1", " ", 
     RowBox[{"(", 
      RowBox[{"\[Omega]1", "+", "\[Omega]2"}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["\[Omega]1", "2"]}], "+", 
       RowBox[{"2", " ", "\[Omega]1", " ", "\[Omega]2"}], "+", 
       SuperscriptBox["\[Omega]2", "2"], "+", 
       RowBox[{"4", " ", "g", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"2", " ", "g", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]", "+", "\[Theta]"}], "]"}]}]}], ")"}]}]}]}],
  SequenceForm[
  "E = ", $CellContext`\[Omega]1 ($CellContext`\[Omega]1 + $CellContext`\
\[Omega]2) Cos[$CellContext`\[Alpha]] + 
   Rational[1, 2] (3 $CellContext`\[Omega]1^2 + 
     2 $CellContext`\[Omega]1 $CellContext`\[Omega]2 + \
$CellContext`\[Omega]2^2 + 4 $CellContext`g Cos[$CellContext`\[Theta]] + 
     2 $CellContext`g Cos[$CellContext`\[Alpha] + $CellContext`\[Theta]])],
  Editable->False]], "Print",
 CellChangeTimes->{3.9226030276761*^9},
 CellLabel->
  "During evaluation of \
In[1372]:=",ExpressionUUID->"bea165a7-c076-4646-b749-1bfbd7e6dadc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"L", "/.", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", "->", 
     RowBox[{"\[Theta]", "+", "\[Beta]"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.922603037024928*^9, 3.9226031133068047`*^9}},
 CellLabel->
  "In[1380]:=",ExpressionUUID->"374a3f8a-4de9-4c62-aa4e-8ada8a25edd4"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", " ", 
     SuperscriptBox["\[Omega]1", "2"]}], "+", 
    RowBox[{"2", " ", "\[Omega]1", " ", "\[Omega]2"}], "+", 
    SuperscriptBox["\[Omega]2", "2"], "+", 
    RowBox[{"2", " ", "\[Omega]1", " ", 
     RowBox[{"(", 
      RowBox[{"\[Omega]1", "+", "\[Omega]2"}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
    RowBox[{"2", " ", "g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Beta]", "+", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Theta]"}], "]"}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.922603052432804*^9, 3.922603114404846*^9}},
 CellLabel->
  "Out[1380]=",ExpressionUUID->"3dd81552-e15b-4809-8e1a-b2718f90b542"]
}, Open  ]]
},
WindowSize->{808, 897},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 for Mac OS X x86 (64-bit) (December 12, 2023)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Users", "nolanking", 
   "Library", "Mathematica", "SystemFiles", "FrontEnd", "StyleSheets"}, 
  "Dracula.nb", CharacterEncoding -> "UTF-8"],
ExpressionUUID->"52329573-1231-40c4-b521-d54f5c42ee69"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1780, 27, 70, "Input",ExpressionUUID->"035e3a20-2905-4eac-88b7-5e28edc4a27e"],
Cell[2341, 49, 479, 10, 48, "Input",ExpressionUUID->"59dab671-9ba0-4b7c-bce0-330c0e5931f0"],
Cell[2823, 61, 2532, 55, 154, "Input",ExpressionUUID->"687be03f-4b0b-4121-928d-35ee0515c044"],
Cell[CellGroupData[{
Cell[5380, 120, 3810, 102, 196, "Input",ExpressionUUID->"82827647-4895-4b98-a331-e24511d5a1c9"],
Cell[9193, 224, 531, 9, 34, "Output",ExpressionUUID->"8f0cabd7-3f83-4836-bb81-d3d46e4caeb6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9761, 238, 364, 9, 48, "Input",ExpressionUUID->"2399f634-910d-456d-9adc-713855ccc670"],
Cell[10128, 249, 159, 3, 34, "Output",ExpressionUUID->"e581d11a-af6f-428a-81d4-e3048d988479"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10324, 257, 1041, 26, 48, "Input",ExpressionUUID->"14e66be6-43ca-485c-a18d-a1b51b4d4d9a"],
Cell[11368, 285, 297, 5, 34, "Output",ExpressionUUID->"1bad40ad-ddd0-4374-829e-f61f1bf497f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11702, 295, 5381, 133, 343, "Input",ExpressionUUID->"28e9b664-16f5-45b5-a8b3-b37a49449536"],
Cell[17086, 430, 1804, 49, 87, "Output",ExpressionUUID->"44a219d1-5b86-4d8d-8bb2-852c4328fc55"],
Cell[18893, 481, 612, 10, 34, "Output",ExpressionUUID->"65444e57-6719-4db9-9b86-4e2b4f2e8c94"],
Cell[19508, 493, 695, 14, 24, "Print",ExpressionUUID->"fd899969-f47a-4236-be95-0c2ee0118355"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20240, 512, 1689, 46, 133, "Input",ExpressionUUID->"dbca5b09-1214-4be0-a0c3-d179cf565664"],
Cell[21932, 560, 1417, 43, 87, "Output",ExpressionUUID->"1601102f-223c-46ba-ad7b-fc9fb33c6ab3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23386, 608, 878, 26, 70, "Input",ExpressionUUID->"8b1bda59-3e70-42c0-a79c-c404d22da849"],
Cell[24267, 636, 1740, 50, 78, "Output",ExpressionUUID->"0fd69742-b822-4c19-be79-9ea494ecddb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26044, 691, 1393, 36, 70, "Input",ExpressionUUID->"c636ac82-c9d0-4959-aa93-014c7e082334"],
Cell[27440, 729, 1891, 52, 72, "Output",ExpressionUUID->"b12680e1-c655-4089-8d54-bf6555139d49"],
Cell[29334, 783, 2092, 57, 56, "Output",ExpressionUUID->"7d49913f-a041-48c8-9e13-18106ccaa81b"],
Cell[31429, 842, 1424, 36, 34, "Output",ExpressionUUID->"fc4a5e02-8e40-40f2-8d05-4698606de230"]
}, Open  ]],
Cell[32868, 881, 2369, 52, 70, "Input",ExpressionUUID->"d3b9c01c-0f50-449d-b808-3b5845af9082"],
Cell[CellGroupData[{
Cell[35262, 937, 2536, 55, 112, "Input",ExpressionUUID->"56c42327-e744-44cc-8adc-a032ef37ac7e"],
Cell[CellGroupData[{
Cell[37823, 996, 1354, 34, 39, "Print",ExpressionUUID->"309d0d7c-6f40-445b-8b98-d94fdc0d2399"],
Cell[39180, 1032, 1315, 32, 39, "Print",ExpressionUUID->"bea165a7-c076-4646-b749-1bfbd7e6dadc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40544, 1070, 336, 9, 48, "Input",ExpressionUUID->"374a3f8a-4de9-4c62-aa4e-8ada8a25edd4"],
Cell[40883, 1081, 901, 24, 49, "Output",ExpressionUUID->"3dd81552-e15b-4809-8e1a-b2718f90b542"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

